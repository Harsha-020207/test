<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>The Facts Time</title>
<style>
  /* Body and header */
  body { margin:0; background:#e0e0e0; font-family:Georgia, serif; color:#000; }
  header {
    background: transparent; color:#000; text-align:center;
    padding:20px; font-size:2.5rem; text-transform:uppercase;
    letter-spacing:2px; position:relative;
  }

  /* Top-right auth buttons */
  .auth-buttons { position:absolute; top:20px; right:20px; }
  .auth-buttons button {
    margin-left:8px; padding:8px 16px; font-size:0.9rem;
    font-weight:bold; border:none; border-radius:999px;
    background:#1e7b78f3; color:white; cursor:pointer; transition: all 0.3s ease;
  }
  .auth-buttons button:hover { background:#145957; }

  /* Date display */
  #date { text-align:center; font-size:1rem; margin-bottom:10px; }

  /* Menu buttons */
  .menu { text-align:center; padding:20px 10px; }
  .menu button {
    margin:5px 10px; padding:10px 24px; font-size:1rem; font-weight:bold;
    border:none; background:#fff; color:#000; cursor:pointer; border-radius:999px;
    transition: all 0.3s ease; box-shadow:0 2px 5px rgba(0,0,0,0.1);
  }
  .menu button:hover, .menu button.active { 
    background:#1e7b78f3; color:#fff; box-shadow:0 0 12px #1e7b78f3; 
  }

  /* News container */
  #news-container {
    max-width:900px; margin:30px auto; background:rgba(255,255,255,0.7);
    padding:40px 30px; border-radius:12px; box-shadow:0 4px 20px rgba(0,0,0,0.1);
    min-height:200px; display:none;
  }
  .article { margin-bottom:28px; padding-bottom:18px; border-bottom:1px solid rgba(0,0,0,0.08); }
  .article:last-child { border-bottom:none; }
  .article h3 { font-size:1.35rem; font-weight:700; margin:0 0 10px; line-height:1.3; }
  .meta { font-size:0.9rem; opacity:0.8; margin:4px 0 10px; }
  .article img { width:100%; max-height:360px; object-fit:cover; border-radius:8px; margin:8px 0 12px; }
  .desc { font-size:1.05rem; line-height:1.6; white-space:pre-wrap; }
  .toggle { display:inline-block; margin-top:10px; padding:8px 14px; border-radius:999px; border:none; cursor:pointer; font-weight:600; background:#fff; transition: all .2s ease; }
  .toggle:hover { background:#1e7b78f3; color:#fff; }
  .inline-expanded { background:rgba(30,123,120,0.06); border-left:4px solid #1e7b78f3; padding:12px 14px; border-radius:8px; margin-top:10px; display:none; }

  /* Navigation buttons */
  .nav-buttons { text-align:center; margin:20px auto 40px; }
  .nav-buttons button {
    padding:10px 24px; margin:0 10px; font-size:1rem; font-weight:bold;
    border:none; border-radius:999px; background:#fff; cursor:pointer; transition:all 0.3s ease;
  }
  .nav-buttons button:hover { background:#1e7b78f3; color:#fff; }

  /* Footer */
  footer { text-align:center; font-size:0.9rem; background:#000; color:white; padding:15px; }

  /* Overlay for login/register */
  .overlay {
    position:fixed; top:0; left:0; width:100%; height:100%;
    background:rgba(0,0,0,0.7); display:none; justify-content:center; align-items:center;
    z-index:9999; overflow-y:auto;
  }
  .box {
    background:white; padding:30px; border-radius:12px;
    width:350px; max-height:90%; overflow-y:auto; text-align:center;
    box-shadow:0 5px 20px rgba(0,0,0,0.3);
  }
  .box h2 { margin-bottom:20px; }
  .box input, .box select, .box textarea { width:90%; padding:10px; margin:8px 0; border:1px solid #ccc; border-radius:6px; }
  .box button { margin-top:10px; width:95%; padding:10px; border:none; border-radius:6px; background:#1e7b78f3; color:white; font-weight:bold; cursor:pointer; }
  .box button:hover { background:#145957; }
  .password-wrapper { position:relative; width:100%; box-sizing:border-box; }
  .password-wrapper input { width:100%; padding-right:40px; box-sizing:border-box; }
  .toggle-eye { position:absolute; top:50%; right:10px; transform:translateY(-50%); cursor:pointer; font-size:18px; user-select:none; }
</style>
</head>
<body>

<header>
  The Facts Time
  <div class="auth-buttons">
    <button onclick="openLogin()">Login</button>
    <button onclick="openRegister()">Register</button>
  </div>
</header>
<div id="date">Loading date...</div>

<div class="menu">
  <button onclick="showCategory(0)" class="active">Business</button>
  <button onclick="showCategory(1)">Climate</button>
  <button onclick="showCategory(2)">Crime</button>
  <button onclick="showCategory(3)">Movies</button>
  <button onclick="showCategory(4)">Sports</button>
</div>

<div id="news-container">Loading news...</div>

<div class="nav-buttons">
  <button id="prevBtn" onclick="prevTab()">Previous</button>
  <button id="nextBtn" onclick="nextTab()">Next</button>
</div>

<footer>&copy; 2025 The Facts Time | All Rights Reserved</footer>

<!-- Login Overlay -->
<div class="overlay" id="loginOverlay">
  <div class="box">
    <h2>Login</h2>
    <form id="loginForm">
      <input type="text" id="loginUser" placeholder="Username or Email" required>
      <div class="password-wrapper">
        <input type="password" id="loginPass" placeholder="Password" required>
        <span class="toggle-eye" onclick="togglePassword('loginPass', this)">üëÅÔ∏è</span>
      </div>
      <p id="loginError" style="color:red;"></p>
      <button type="submit">Login</button>
      <button type="button" onclick="closeLogin()">Back</button>
    </form>
  </div>
</div>

<!-- Register Overlay -->
<div class="overlay" id="registerOverlay">
  <div class="box">
    <h2>Register</h2>
    <form id="registerForm">
      <input type="text" id="fname" placeholder="First Name" required>
      <input type="text" id="lname" placeholder="Last Name" required>
      <label>Date of Birth:</label><br>
      <select id="day" required></select>
      <select id="month" required></select>
      <select id="year" required></select><br>
      <label>Gender:</label><br>
      <input type="radio" name="gender" value="Male" required> Male
      <input type="radio" name="gender" value="Female"> Female
      <input type="radio" name="gender" value="Other"> Other<br>
      <input type="text" id="regUser" placeholder="Username" required>
      <div class="password-wrapper">
        <input type="password" id="regPass" placeholder="Password" required>
        <span class="toggle-eye" onclick="togglePassword('regPass', this)">üëÅÔ∏è</span>
      </div>
      <div class="password-wrapper">
        <input type="password" id="regConfirm" placeholder="Confirm Password" required>
        <span class="toggle-eye" onclick="togglePassword('regConfirm', this)">üëÅÔ∏è</span>
      </div>
      <textarea id="address" rows="3" placeholder="Address" required></textarea>
      <p id="regError" style="color:red;"></p>
      <button type="submit">Register</button>
      <button type="button" onclick="closeRegister()">Back</button>
    </form>
  </div>
</div>

<script>
const apiKey="c6f4aa7f0316c81c76e7092b411c17d1";
const categories=["Business","Climate","Crime","Movies","Sports"];
let currentTab=0;
const searchQueries={
  Business:"business OR economy OR finance OR startup",
  Climate:"climate OR environment OR pollution OR global warming",
  Crime:"crime OR police OR fraud OR scam",
  Movies:"Bollywood OR movies OR cinema OR film",
  Sports:"cricket OR football OR sports OR tennis"
};
const newsCache={};

/* ----------- Display current date ----------- */
document.getElementById('date').textContent=new Date().toLocaleDateString(undefined,{
  weekday:'long',year:'numeric',month:'long',day:'numeric'
});

/* ----------- Overlay functions ----------- */
function openLogin(){ document.getElementById('loginOverlay').style.display='flex'; }
function closeLogin(){ document.getElementById('loginOverlay').style.display='none'; }
function openRegister(){ 
  document.getElementById('registerOverlay').style.display='flex'; 
  populateDOB(); 
}
function closeRegister(){ document.getElementById('registerOverlay').style.display='none'; }
function togglePassword(id){ 
  const input=document.getElementById(id);
  input.type = input.type === "password" ? "text" : "password"; 
}

/* ----------- Populate DOB ----------- */
function populateDOB(){
  const day=document.getElementById('day'), month=document.getElementById('month'), year=document.getElementById('year');
  if(day.options.length===0){
    for(let i=1;i<=31;i++) day.add(new Option(i,i));
    ["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].forEach((m,i)=>month.add(new Option(m,i+1)));
    const currentYear=new Date().getFullYear();
    for(let y=currentYear;y>=1900;y--) year.add(new Option(y,y));
  }
}

/* ----------- Login/Register state ----------- */
function setLoggedIn(user){
  document.querySelector('.auth-buttons').style.display='none';
  let topRight=document.querySelector('header');
  let div=document.createElement('div');
  div.id='welcomeDiv';
  div.style.position='absolute'; div.style.top='20px'; div.style.right='20px'; div.style.fontSize='0.9rem'; div.style.fontWeight='bold';
  div.innerHTML=`Welcome, ${user} <button onclick="logout()" style="margin-left:8px;padding:5px 10px;border:none;border-radius:5px;background:#1e7b78;color:white;cursor:pointer;">Logout</button>`;
  topRight.appendChild(div);
}

function logout(){
  localStorage.removeItem('username');
  document.getElementById('welcomeDiv').remove();
  document.querySelector('.auth-buttons').style.display='block';
}

/* ----------- Auto-show login/register overlay after 5s ----------- */
window.addEventListener('load', ()=>{
  const remembered=localStorage.getItem('username');
  if(remembered) setLoggedIn(remembered);
  else setTimeout(showAuthChoiceOverlay, 5000);
});

function showAuthChoiceOverlay(){
  const overlay=document.createElement('div');
  overlay.id='authChoiceOverlay';
  overlay.className='overlay';
  overlay.style.display='flex';
  const box=document.createElement('div');
  box.className='box';
  box.innerHTML=`
    <h2>Welcome! Please Login or Register</h2>
    <button onclick="openLogin(); closeAuthChoice()">Login</button>
    <button onclick="openRegister(); closeAuthChoice()">Register</button>
  `;
  overlay.appendChild(box);
  document.body.appendChild(overlay);
}

function closeAuthChoice(){
  const overlay=document.getElementById('authChoiceOverlay');
  if(overlay) overlay.remove();
}

/* ----------- Login/Register form submit ----------- */
document.getElementById('registerForm').addEventListener('submit',function(e){
  e.preventDefault();
  const user=document.getElementById('regUser').value.trim();
  const fname=document.getElementById('fname').value.trim();
  const lname=document.getElementById('lname').value.trim();
  alert(`Registration successful!\nWelcome ${fname} ${lname}`);
  closeRegister();
  setLoggedIn(user);
});

document.getElementById('loginForm').addEventListener('submit',function(e){
  e.preventDefault();
  const user=document.getElementById('loginUser').value.trim();
  alert(`Login successful! Welcome back ${user}`);
  closeLogin();
  setLoggedIn(user);
});

/* ----------- News functions ----------- */
function showCategory(index){
  currentTab=index;
  document.querySelectorAll(".menu button").forEach((btn,i)=>btn.classList.toggle("active",i===index));
  document.getElementById("prevBtn").disabled=index===0;
  document.getElementById("nextBtn").disabled=index===categories.length-1;
  if(newsCache[categories[index]]) renderNews(newsCache[categories[index]]);
  else fetchNews(categories[index]);
}

function prevTab(){ if(currentTab>0) showCategory(currentTab-1); }
function nextTab(){ if(currentTab<categories.length-1) showCategory(currentTab+1); }

async function fetchNews(category){
  const query=searchQueries[category];
  const url=`https://gnews.io/api/v4/search?q=${encodeURIComponent(query)}&lang=en&country=in&max=6&apikey=${apiKey}`;
  const container=document.getElementById("news-container");
  container.innerHTML="Loading news...";
  try{
    const res=await fetch(url); const data=await res.json();
    newsCache[category]=data; renderNews(data,category);
  }catch(err){ container.innerHTML=`<p style="color:red;">Error: ${err.message}</p>`; }
}

function renderNews(data,category){
  const container=document.getElementById("news-container"); 
  container.style.display="block";
  if(!data.articles||data.articles.length===0){
    container.innerHTML=`<p>No news found for <strong>${category}</strong>.</p>`; 
    return;
  }
  container.innerHTML=`<div style="text-transform:uppercase;font-weight:bold;margin-bottom:10px;">${category}</div>`;
  data.articles.forEach(a=>{
    const div=document.createElement("div"); div.className="article";
    div.innerHTML=`
      <h3>${a.title}</h3>
      <div class="meta">${a.source?.name||""} ¬∑ ${new Date(a.publishedAt).toLocaleString()}</div>
      ${a.image?`<img src="${a.image}" onerror="this.style.display='none'">`:''}
      <div class="desc">${a.description||'No description available.'}</div>
      <div class="inline-expanded">${a.content||'Full content not available.'}</div>
      <button class="toggle">Read more</button>`;
    const toggleBtn=div.querySelector(".toggle"); 
    const expanded=div.querySelector(".inline-expanded");
    toggleBtn.addEventListener("click",()=>{
      const hidden=expanded.style.display===''||expanded.style.display==='none';
      expanded.style.display=hidden?'block':'none';
      toggleBtn.textContent=hidden?'Show less':'Read more';
    });
    container.appendChild(div);
  });
}

// Initialize first category
showCategory(0);
</script>

</body>
</html>
